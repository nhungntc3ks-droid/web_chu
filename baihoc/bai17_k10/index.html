<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i 17: Bi·∫øn v√† L·ªánh g√°n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Ch·ªëng b·∫•m chu·ªôt ph·∫£i v√† c√°c thao t√°c can thi·ªáp video */
        .video-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 90%; z-index: 10; cursor: default; }
    </style>
</head>
<body class="bg-slate-100 font-sans p-2 md:p-10">

    <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden border-t-8 border-blue-700 relative">
        <div class="p-4 text-center">
            <h1 class="text-xl md:text-2xl font-black text-blue-900 uppercase">B√ÄI 17: BI·∫æN V√Ä L·ªÜNH G√ÅN</h1>
            <p id="status-msg" class="text-red-500 font-bold text-xs mt-1">H·ªá th·ªëng ƒëang theo d√µi qu√° tr√¨nh h·ªçc c·ªßa b·∫°n...</p>
        </div>

        <div class="relative aspect-video bg-black">
            <div id="player"></div>
            <div class="video-overlay"></div>
        </div>

        <div id="quiz-container" class="hidden absolute inset-0 z-50 bg-blue-900/95 flex items-center justify-center p-6">
            <div class="bg-white p-8 rounded-2xl max-w-lg w-full shadow-2xl">
                <h3 id="question-text" class="text-lg font-black text-blue-900 mb-4 uppercase">ƒêANG T·∫¢I C√ÇU H·ªéI...</h3>
                <div id="options" class="space-y-3">
                    </div>
                <p id="feedback" class="mt-4 text-sm font-bold hidden"></p>
            </div>
        </div>

        <div id="finish-section" class="hidden p-10 text-center bg-green-50">
            <h2 class="text-xl font-black text-green-700 uppercase mb-4">üéâ Tuy·ªát v·ªùi! B·∫°n ƒë√£ ho√†n th√†nh b√†i h·ªçc</h2>
            <a href="LINK_BAI_TAP_CUA_BAN" class="inline-block bg-blue-700 text-white font-black py-4 px-10 rounded-2xl shadow-xl">TI·∫æP T·ª§C L√ÄM B√ÄI T·∫¨P ‚Üí</a>
        </div>
    </div>

    <script>
        // 1. Kh·ªüi t·∫°o YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;
        var quizPoints = [
            { 
                time: 45, 
                retryTime: 3, 
                question: "Trong Python, l·ªánh n√†o sau ƒë√¢y l√† l·ªánh g√°n ƒë√∫ng?",
                options: ["x = 5", "5 = x", "x : 5", "g√°n x b·∫±ng 5"],
                answer: 0 
            },
            { 
                time: 68, 
                retryTime: 46, 
                question: "T√™n bi·∫øn n√†o sau ƒë√¢y l√† H·ª¢P L·ªÜ trong Python?",
                options: ["10tin_hoc", "tin hoc", "tin_hoc_10", "if"],
                answer: 2 
            }
        ];
        var currentQuizIndex = 0;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: 'YytWVMRwtNQ',
                playerVars: {
                    'controls': 0,      // ·∫®n b·ªô ƒëi·ªÅu khi·ªÉn ƒë·ªÉ ch·ªëng tua
                    'disablekb': 1,    // Ch·∫∑n ph√≠m t·∫Øt
                    'rel': 0,
                    'modestbranding': 1
                },
                events: {
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 2. Theo d√µi th·ªùi gian th·ª±c c·ªßa video
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                var checkTime = setInterval(function() {
                    if (currentQuizIndex < quizPoints.length) {
                        var point = quizPoints[currentQuizIndex];
                        if (player.getCurrentTime() >= point.time) {
                            clearInterval(checkTime);
                            showQuiz(point);
                        }
                    } else if (player.getCurrentTime() >= player.getDuration() - 1) {
                        document.getElementById('finish-section').classList.remove('hidden');
                        document.getElementById('status-msg').innerText = "Ho√†n th√†nh!";
                        clearInterval(checkTime);
                    }
                }, 500);
            }
        }

        // 3. Hi·ªÉn th·ªã c√¢u h·ªèi
        function showQuiz(point) {
            player.pauseVideo();
            const container = document.getElementById('quiz-container');
            const qText = document.getElementById('question-text');
            const optionsDiv = document.getElementById('options');
            
            qText.innerText = point.question;
            optionsDiv.innerHTML = "";
            container.classList.remove('hidden');

            point.options.forEach((opt, index) => {
                let btn = document.createElement('button');
                btn.className = "w-full text-left p-4 border-2 border-gray-200 rounded-xl font-bold hover:bg-blue-50 transition";
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(index, point);
                optionsDiv.appendChild(btn);
            });
        }

        // 4. Ki·ªÉm tra ƒë√°p √°n
        function checkAnswer(selectedIndex, point) {
            const feedback = document.getElementById('feedback');
            feedback.classList.remove('hidden');

            if (selectedIndex === point.answer) {
                feedback.innerText = "‚úÖ CH√çNH X√ÅC! B·∫°n c√≥ th·ªÉ xem ti·∫øp.";
                feedback.className = "mt-4 text-sm font-bold text-green-600";
                setTimeout(() => {
                    document.getElementById('quiz-container').classList.add('hidden');
                    feedback.classList.add('hidden');
                    currentQuizIndex++;
                    player.playVideo();
                }, 1500);
            } else {
                feedback.innerText = "‚ùå SAI R·ªíI! B·∫°n ph·∫£i quay l·∫°i xem k·ªπ ph·∫ßn n√†y.";
                feedback.className = "mt-4 text-sm font-bold text-red-600";
                setTimeout(() => {
                    document.getElementById('quiz-container').classList.add('hidden');
                    feedback.classList.add('hidden');
                    player.seekTo(point.retryTime); // Quay l·∫°i v·ªã tr√≠ y√™u c·∫ßu
                    player.playVideo();
                }, 2000);
            }
        }
    </script>
</body>

</html>
